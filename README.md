# UX/CX Research — Карта компетенций

Интерактивный инструмент оценки компетенций UX/CX исследователей.
Поддерживает три роли: самооценка, оценка лидом команды, оценка лидом продукта.

## Запуск

```bash
npm install
npm run dev
```

Приложение будет доступно по адресу [http://localhost:3000](http://localhost:3000).

## Совместная оценка (Supabase)

Три разных человека могут оценить исследователя со своих устройств через общую сессию.

### Как настроить

1. Создайте бесплатный проект на [supabase.com](https://supabase.com)
2. В **SQL Editor** выполните содержимое файла `supabase-schema.sql`
3. Скопируйте `.env.local.example` в `.env.local`:
   ```bash
   cp .env.local.example .env.local
   ```
4. Заполните переменные в `.env.local` значениями из **Settings → API** в Supabase Dashboard:
   - `NEXT_PUBLIC_SUPABASE_URL` — Project URL
   - `NEXT_PUBLIC_SUPABASE_ANON_KEY` — anon / public key
5. Перезапустите `npm run dev`

### Как пользоваться

1. **Исследователь** нажимает «Создать сессию» → получает 6-символьный код
2. Делится кодом с **лидом команды** и **лидом продукта**
3. Каждый участник:
   - Открывает приложение
   - Нажимает «У меня есть код» → вводит код
   - Выбирает свою роль → проходит оценку
4. Ответы автоматически сохраняются в Supabase
5. Любой участник может посмотреть сравнительные результаты на странице «Результаты»

> Без Supabase приложение работает в локальном режиме (всё хранится в localStorage одного браузера).

## Роли оценки

| Роль | Описание |
|------|----------|
| **Самооценка** | Исследователь оценивает себя |
| **Лид команды** | Лид исследователей оценивает сотрудника |
| **Лид продукта** | Продуктовый лид оценивает сотрудника |

Каждая роль заполняет одинаковый набор из 96 утверждений. Результаты всех ролей отображаются на одном экране с наложением на радар-чарте, сравнительной таблицей и выявлением «слепых зон».

## Структура проекта

```
uxcx-assessment/
├── app/                    # Страницы (App Router)
│   ├── page.tsx            # Welcome — сессия + выбор роли
│   ├── assessment/page.tsx # Прохождение оценки
│   └── results/page.tsx    # Результаты и сравнение
├── components/             # UI-компоненты
├── lib/
│   ├── data-loader.ts      # Загрузка модели, CSV и axis_mapping
│   ├── scoring.ts          # Движок подсчёта + calculateGaps()
│   ├── interpretation.ts   # Интерпретация результатов
│   ├── supabase.ts         # Supabase-клиент (опционально)
│   ├── session.ts          # CRUD сессий (создание, сохранение, загрузка)
│   ├── useSyncSession.ts   # Хук автосинхронизации ответов
│   └── useHydration.ts     # SSR-safe hydration hook
├── store/
│   └── useAssessmentStore.ts # Zustand (мультиролевое состояние + localStorage)
├── types/
│   └── index.ts            # TypeScript-типы и роли
├── public/data/
│   ├── competency_model.json # Модель компетенций
│   ├── axis_mapping.json     # Маппинг осей → компетенций
│   └── assessment_items.csv  # Банк вопросов
├── supabase-schema.sql     # SQL для создания таблицы
└── .env.local.example      # Шаблон переменных окружения
```

## Как редактировать банк вопросов

Файл: `public/data/assessment_items.csv`

```
item_id,competency_id,level_target,statement
PS_01,hard_problem_setting,2,Я уточняю исследовательский запрос перед началом работы
```

- **item_id** — уникальный идентификатор вопроса
- **competency_id** — ID компетенции из `competency_model.json`
- **level_target** — целевой уровень (2–5)
- **statement** — текст утверждения для оценки

При добавлении новой компетенции: добавьте её в `competency_model.json` и `axis_mapping.json`, затем создайте вопросы в CSV.

## Как работает скоринг

Подробные правила: см. `scoring_rules.md`

### Уровень компетенции
Для каждого `level_target` проверяются два условия:
1. Средний балл ответов ≥ 4
2. Минимум 60% ответов ≥ 4

Компетенция получает **максимальный уровень**, удовлетворяющий обоим условиям. Если ни один — уровень 1.

### Уровень оси
Среднее арифметическое уровней компетенций внутри оси, округлённое вниз.

### Общий уровень
Наибольшее N, при котором:
- минимум 2 из 3 осей ≥ N
- ни одна ось < N − 1

### Слепые зоны (мультиролевой режим)
Когда заполнены оценки нескольких ролей, система выявляет компетенции, где самооценка расходится с внешней оценкой на ≥ 2 уровня.
