import type { AssessmentResults } from "@/types";

interface InterpretationBlock {
  title: string;
  text: string;
}

export function getInterpretation(
  results: AssessmentResults
): InterpretationBlock[] {
  const craft = results.axisScores["Craft"]?.level ?? 0;
  const impact = results.axisScores["Impact"]?.level ?? 0;
  const leadership = results.axisScores["Leadership"]?.level ?? 0;

  const blocks: InterpretationBlock[] = [];

  const allHigh = craft >= 4 && impact >= 4 && leadership >= 4;

  if (allHigh) {
    blocks.push({
      title: "Стратегический исследователь",
      text: "Ваш профиль сбалансирован по всем трём осям. Вы сочетаете глубокую методологическую экспертизу с системным влиянием на продукт и способностью развивать людей и процессы. Это позволяет вам решать задачи любого масштаба — от тактических до стратегических.",
    });
    return blocks;
  }

  if (craft >= 4 && impact < 3) {
    blocks.push({
      title: "Эксперт без системного влияния",
      text: "Вы демонстрируете сильную методологическую базу (Craft), но ваше влияние на продуктовые и бизнес-решения пока ограничено. Рекомендуем больше вовлекаться в работу с результатами исследований, приоритизацию задач и коммуникацию со стейкхолдерами.",
    });
  }

  if (impact >= 4 && craft <= 3) {
    blocks.push({
      title: "Организационный драйвер",
      text: "Вы отлично выстраиваете коммуникацию и доносите ценность исследований до команды и бизнеса. При этом стоит укрепить методологическую базу — работу с дизайном исследований, анализом данных и проведением полевых этапов.",
    });
  }

  if (leadership >= 4) {
    blocks.push({
      title: "Лидер и наставник",
      text: "Ваш уровень лидерства позволяет вам не только проводить исследования, но и развивать культуру и команду. Вы влияете на процессы и стандарты, помогаете расти другим исследователям.",
    });
  }

  if (craft >= 3 && impact >= 3 && leadership < 3) {
    blocks.push({
      title: "Крепкий практик",
      text: "Вы хорошо владеете методологией и умеете доносить результаты. Следующий шаг — развитие лидерских компетенций: менторство, формирование практик, влияние на стандарты работы команды.",
    });
  }

  if (blocks.length === 0) {
    blocks.push({
      title: "Формирование профиля",
      text: "Вы находитесь на этапе активного формирования профессионального профиля. Сосредоточьтесь на базовых навыках проведения исследований, качественной презентации результатов и выстраивании рабочих отношений с командой.",
    });
  }

  return blocks;
}

export function getDevelopmentFocus(
  competencyId: string
): string {
  const focusMap: Record<string, string> = {
    hard_problem_setting:
      "Практикуйте переформулировку запросов стейкхолдеров, выявляйте скрытые предположения и учитесь отделять симптомы от корневых проблем.",
    hard_design:
      "Экспериментируйте с комбинацией методов, учитывайте ограничения и риски, документируйте обоснования выбора дизайна.",
    hard_execution:
      "Работайте над гибкостью в проведении исследований, фиксируйте поведенческие паттерны, практикуйте работу со сложными респондентами.",
    hard_analysis:
      "Развивайте навыки синтеза, учитесь выявлять причинно-следственные связи и работать с противоречивыми данными.",
    hard_results:
      "Связывайте выводы с бизнес-задачами, формулируйте actionable-рекомендации и отслеживайте влияние исследований на решения.",
    soft_briefing:
      "Учитесь выявлять реальные цели за формальными запросами, переопределять проблему и выравнивать ожидания стейкхолдеров.",
    soft_presentation:
      "Адаптируйте подачу под аудиторию, тренируйте аргументацию и работу с сопротивлением.",
    soft_researchers:
      "Помогайте коллегам через менторство, review исследований и формирование практик внутри команды.",
    soft_colleagues:
      "Выстраивайте доверительные отношения, помогайте команде принимать решения на основе данных.",
    soft_leaders:
      "Практикуйте аргументированную защиту выводов перед руководством, обсуждайте стратегические гипотезы.",
    soft_business:
      "Связывайте исследования с бизнес-метриками, формулируйте выводы через призму ценности для бизнеса.",
    hard_quant_design:
      "Углубляйте знания в проектировании опросов, работе с выборками и контроле качества анкет.",
    hard_quant_analysis:
      "Развивайте навыки статистического анализа, учитесь выбирать подходящие тесты и интерпретировать результаты.",
  };

  return (
    focusMap[competencyId] ??
    "Сосредоточьтесь на практике и получении обратной связи от более опытных коллег."
  );
}
